<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>app/common/datepicker/mobiscroll.core.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/adverstAdapter.html">adverstAdapter</a></li>
                                <li><a href="../classes/AdverstCollection.html">AdverstCollection</a></li>
                                <li><a href="../classes/AdverstModel.html">AdverstModel</a></li>
                                <li><a href="../classes/al_notifications.html">al_notifications</a></li>
                                <li><a href="../classes/app.html">app</a></li>
                                <li><a href="../classes/AppHomeRouter.html">AppHomeRouter</a></li>
                                <li><a href="../classes/AppRouter.html">AppRouter</a></li>
                                <li><a href="../classes/AppShopDetailRouter.html">AppShopDetailRouter</a></li>
                                <li><a href="../classes/AppShopListRouter.html">AppShopListRouter</a></li>
                                <li><a href="../classes/areaAdapter.html">areaAdapter</a></li>
                                <li><a href="../classes/AreaCollection.html">AreaCollection</a></li>
                                <li><a href="../classes/AreaInitItemView.html">AreaInitItemView</a></li>
                                <li><a href="../classes/AreaInitView.html">AreaInitView</a></li>
                                <li><a href="../classes/AreaListItemView.html">AreaListItemView</a></li>
                                <li><a href="../classes/AreaListView.html">AreaListView</a></li>
                                <li><a href="../classes/AreaModel.html">AreaModel</a></li>
                                <li><a href="../classes/AreaView.html">AreaView</a></li>
                                <li><a href="../classes/BaseView.html">BaseView</a></li>
                                <li><a href="../classes/Carousel.html">Carousel</a></li>
                                <li><a href="../classes/getApi.html">getApi</a></li>
                                <li><a href="../classes/HomeView.html">HomeView</a></li>
                                <li><a href="../classes/loginModel.html">loginModel</a></li>
                                <li><a href="../classes/LoginView.html">LoginView</a></li>
                                <li><a href="../classes/MyView.html">MyView</a></li>
                                <li><a href="../classes/shopAdapter.html">shopAdapter</a></li>
                                <li><a href="../classes/shopDetailAdapter.html">shopDetailAdapter</a></li>
                                <li><a href="../classes/ShopDetailModel.html">ShopDetailModel</a></li>
                                <li><a href="../classes/ShopDetailView.html">ShopDetailView</a></li>
                                <li><a href="../classes/ShopInitCollection.html">ShopInitCollection</a></li>
                                <li><a href="../classes/ShopInitDownView.html">ShopInitDownView</a></li>
                                <li><a href="../classes/ShopInitItemView.html">ShopInitItemView</a></li>
                                <li><a href="../classes/ShopInitView.html">ShopInitView</a></li>
                                <li><a href="../classes/ShopListView.html">ShopListView</a></li>
                                <li><a href="../classes/ShopModel.html">ShopModel</a></li>
                                <li><a href="../classes/ShopResultModel.html">ShopResultModel</a></li>
                                <li><a href="../classes/ShopResultView.html">ShopResultView</a></li>
                                <li><a href="../classes/ShopServerView.html">ShopServerView</a></li>
                                <li><a href="../classes/userAdapter.html">userAdapter</a></li>
                                <li><a href="../classes/userInfoCollection.html">userInfoCollection</a></li>
                                <li><a href="../classes/userModel.html">userModel</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/appconstant.html">appconstant</a></li>
                                <li><a href="../modules/area.html">area</a></li>
                                <li><a href="../modules/common.html">common</a></li>
                                <li><a href="../modules/home.html">home</a></li>
                                <li><a href="../modules/my.html">my</a></li>
                                <li><a href="../modules/shopDetail.html">shopDetail</a></li>
                                <li><a href="../modules/shopList.html">shopList</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: app/common/datepicker/mobiscroll.core.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
﻿/*!
 * jQuery MobiScroll v2.0
 * http://mobiscroll.com
 *
 * Copyright 2010-2011, Acid Media
 * Licensed under the MIT license.
 *
 */
(function (factory) {
    if (typeof exports === &#x27;object&#x27;) {
        module.exports = factory(require(&#x27;Zepto&#x27;,&#x27;app/common/datepicker/mobiscroll.zepto&#x27;));
    } else if (typeof define === &#x27;function&#x27; &amp;&amp; define.amd) {
        define([&#x27;Zepto&#x27;,&#x27;app/common/datepicker/mobiscroll.zepto&#x27;], factory);
    }
}
(function ($) {

    function Scroller(elm, settings) {
        var that = this,
            e = elm,
            elm = $(e),
            theme,
            s = $.extend({}, defaults),
            m,
            dw,
            iv = {},
            tv = {},
            input = elm.is(&#x27;input&#x27;),
            visible = false;

        // Private functions

        function getDocHeight() {
            var body = document.body,
                html = document.documentElement;
            return Math.max(body.scrollHeight, body.offsetHeight, html.clientHeight, html.scrollHeight, html.offsetHeight);
        }

        function setGlobals(t) {
            min = $(&#x27;li.dw-v&#x27;, t).eq(0).index();
            max = $(&#x27;li.dw-v&#x27;, t).eq(-1).index();
            h = s.height;
            inst = that;
        }

        function formatHeader(v) {
            var t = s.headerText;
            return t ? (typeof(t) == &#x27;function&#x27; ? t.call(e, v) : t.replace(/{value}/i, v)) : &#x27;&#x27;;
        }

        function read() {
            that.temp = ((input &amp;&amp; that.val !== null &amp;&amp; that.val != elm.val()) || that.values === null) ? s.parseValue(elm.val() ? elm.val() : &#x27;&#x27;, that) : that.values.slice(0);
            that.setValue(true);
        }

        function scrollToPos(time, orig, index, manual, dir) {
            // Initial validate
            s.validate.call(e, dw, index);

            // Set scrollers to position
            $(&#x27;.dww ul&#x27;, dw).each(function(i) {
                var t = $(this),
                    cell = $(&#x27;li[data-val=&quot;&#x27; + that.temp[i] + &#x27;&quot;]&#x27;, t),
                    x = cell.index(),
                    v = scrollToValid(cell, x, i, dir),
                    sc = i == index || index === undefined;
                if (x != v || sc)
                    that.scroll($(this), v, sc ? time : 0.2, orig, i);
            });

            // Reformat value if validation changed something
            that.change(manual);
        }

        function scrollToValid(cell, val, i, dir) {
            // Process invalid cells
            if (!cell.hasClass(&#x27;dw-v&#x27;)) {
                var cell1 = cell,
                    cell2 = cell,
                    dist1 = 0,
                    dist2 = 0;
                while (cell1.prev().length &amp;&amp; !cell1.hasClass(&#x27;dw-v&#x27;)) {
                    cell1 = cell1.prev();
                    dist1++;
                }
                while (cell2.next().length &amp;&amp; !cell2.hasClass(&#x27;dw-v&#x27;)) {
                    cell2 = cell2.next();
                    dist2++;
                }
                // If we have direction (+/- or mouse wheel), the distance does not count
                if (((dist2 &lt; dist1 &amp;&amp; dist2 &amp;&amp; !dir == 1) || !dist1 || !cell1.hasClass(&#x27;dw-v&#x27;) || dir == 1) &amp;&amp; cell2.hasClass(&#x27;dw-v&#x27;)) {
                    cell = cell2;
                    val = val + dist2;
                }
                else {
                    cell = cell1;
                    val = val - dist1;
                }
                that.temp[i] = cell.attr(&#x27;data-val&#x27;);
            }
            return val;
        }

        function position() {
            var totalw = 0,
                minw = 0,
                ww = $(window).width(),
                wh = $(window).height(),
                st = $(window).scrollTop(),
                o = $(&#x27;.dwo&#x27;, dw),
                d = $(&#x27;.dw&#x27;, dw),
                w,
                h;
            $(&#x27;.dwc&#x27;, dw).each(function() {
                w = $(this).outerWidth(true);
                totalw += w;
                minw = (w &gt; minw) ? w : minw;
            });
            w = totalw &gt; ww ? minw : totalw;
            d.width(w);
            w = d.outerWidth();
            h = d.outerHeight();
            d.css({ left: (ww - w) / 2, top: st + (wh - h) / 2 });
            //o.height(0).height($(document).height());
            o.height(0).height(getDocHeight());
        }

        function plus(t) {
            var p = +t.data(&#x27;pos&#x27;),
                val = p + 1;
            calc(t, val &gt; max ? min : val, 1);
        }

        function minus(t) {
            var p = +t.data(&#x27;pos&#x27;),
                val = p - 1;
            calc(t, val &lt; min ? max : val, 2);
        }

        // Public functions

        /**
        * Enables the scroller and the associated input.
        */
        that.enable = function() {
            s.disabled = false;
            if (input)
                elm.prop(&#x27;disabled&#x27;, false);
        }

        /**
        * Disables the scroller and the associated input.
        */
        that.disable = function() {
            s.disabled = true;
            if (input)
                elm.prop(&#x27;disabled&#x27;, true);
        }

        /**
        * Scrolls target to the specified position
        * @param {Object} t - Target wheel jQuery object.
        * @param {Number} val - Value.
        * @param {Number} [time] - Duration of the animation, optional.
        */
        that.scroll = function(t, val, time, orig, index) {
            var px = (m - val) * s.height;
            t.attr(&#x27;style&#x27;, (time ? (prefix + &#x27;-transition:all &#x27; + time.toFixed(1) + &#x27;s ease-out;&#x27;) : &#x27;&#x27;) + (has3d ? (prefix + &#x27;-transform:translate3d(0,&#x27; + px + &#x27;px,0);&#x27;) : (&#x27;top:&#x27; + px + &#x27;px;&#x27;)));

            function getVal(t, b, c, d) {
                return c * Math.sin(t/d * (Math.PI/2)) + b;
            }

            if (time &amp;&amp; orig !== undefined) {
                var i = 0;
                clearInterval(iv[index]);
                iv[index] = setInterval(function() {
                    i += 0.1;
                    t.data(&#x27;pos&#x27;, Math.round(getVal(i, orig, val - orig, time)));
                    if (i &gt;= time) {
                        clearInterval(iv[index]);
                        t.data(&#x27;pos&#x27;, val);
                    }
                }, 100);
                // Show +/- buttons
                clearTimeout(tv[index]);
                tv[index] = setTimeout(function() {
                    if (s.mode == &#x27;mixed&#x27; &amp;&amp; !t.hasClass(&#x27;dwa&#x27;))
                        t.closest(&#x27;.dwwl&#x27;).find(&#x27;.dwwb&#x27;).fadeIn(&#x27;fast&#x27;);
                }, time * 1000);
            }
            else
                t.data(&#x27;pos&#x27;, val)
        }

        /**
        * Gets the selected wheel values, formats it, and set the value of the scroller instance.
        * If input parameter is true, populates the associated input element.
        * @param {Boolean} [fill] - Also set the value of the associated input element. Default is true.
        */
        that.setValue = function (sc, fill, time) {
            var v = s.formatResult(that.temp);
            that.val = v;
            that.values = that.temp.slice(0);
            if (visible &amp;&amp; sc) scrollToPos(time);
            if (fill &amp;&amp; input) elm.val(v).trigger(&#x27;change&#x27;);
        }

        /**
        * Checks if the current selected values are valid together.
        * In case of date presets it checks the number of days in a month.
        * @param {Integer} i - Currently changed wheel index, -1 if initial validation.
        */
        that.validate = function(time, orig, i, dir) {
            scrollToPos(time, orig, i, true, dir);
        }

        /**
         *
         */
        that.change = function (manual) {
            var v = s.formatResult(that.temp);
            if (s.display == &#x27;inline&#x27;)
                that.setValue(false, manual);
            else
                $(&#x27;.dwv&#x27;, dw).html(formatHeader(v));
            if (manual)
                s.onChange.call(e, v, that);
        }

        /**
        * Hides the scroller instance.
        */
        that.hide = function () {
            // If onClose handler returns false, prevent hide
            if (s.onClose.call(e, that.val, that) === false) return false;
            // Re-enable temporary disabled fields
            $(&#x27;.dwtd&#x27;).prop(&#x27;disabled&#x27;, false).removeClass(&#x27;dwtd&#x27;);
            elm.blur();
            // Hide wheels and overlay
            if (dw)
                dw.remove();
            visible = false;
            // Stop positioning on window resize
            $(window).unbind(&#x27;.dw&#x27;);
        }

        /**
        * Shows the scroller instance.
        */
        that.show = function () {
            if (s.disabled || visible) return false;

            var hi = s.height,
                thi = s.rows * hi;

            // Parse value from input
            read();

            // Create wheels containers
            var html = &#x27;&lt;div class=&quot;&#x27; + s.theme + &#x27;&quot;&gt;&#x27; + (s.display == &#x27;inline&#x27; ? &#x27;&lt;div class=&quot;dw dwbg dwi&quot;&gt;&lt;div class=&quot;dwwr&quot;&gt;&#x27; : &#x27;&lt;div class=&quot;dwo&quot;&gt;&lt;/div&gt;&lt;div class=&quot;dw dwbg&quot;&gt;&lt;div class=&quot;dwwr&quot;&gt;&#x27; + (s.headerText ? &#x27;&lt;div class=&quot;dwv&quot;&gt;&lt;/div&gt;&#x27; : &#x27;&#x27;));
            for (var i = 0; i &lt; s.wheels.length; i++) {
                html += &#x27;&lt;div class=&quot;dwc&#x27; + (s.mode != &#x27;scroller&#x27; ? &#x27; dwpm&#x27; : &#x27; dwsc&#x27;) + (s.showLabel ? &#x27;&#x27; : &#x27; dwhl&#x27;) + &#x27;&quot;&gt;&lt;div class=&quot;dwwc dwrc&quot;&gt;&lt;table cellpadding=&quot;0&quot; cellspacing=&quot;0&quot;&gt;&lt;tr&gt;&#x27;;
                // Create wheels
                for (var label in s.wheels[i]) {
                    console.log(s.wheels[i]);
                    /*changed by huangjc*/
                    html += &#x27;&lt;td&gt;&lt;div class=&quot;dwwl dwrc&quot;&gt;&#x27; + &#x27;&lt;div class=&quot;dww dwrc&quot; style=&quot;height:&#x27; + thi + &#x27;px;min-width:&#x27; + s.width + &#x27;px;&quot;&gt;&lt;ul&gt;&#x27;;
//                    html += &#x27;&lt;td&gt;&lt;div class=&quot;dwwl dwrc&quot;&gt;&#x27; + &#x27;&lt;div class=&quot;dwl&quot;&gt;&#x27; + label + &#x27;&lt;/div&gt;&lt;div class=&quot;dww dwrc&quot; style=&quot;height:&#x27; + thi + &#x27;px;min-width:&#x27; + s.width + &#x27;px;&quot;&gt;&lt;ul&gt;&#x27;;
                    // Create wheel values
                    for (var j in s.wheels[i][label]) {
                        html += &#x27;&lt;li class=&quot;dw-v&quot; data-val=&quot;&#x27; + j + &#x27;&quot; style=&quot;height:&#x27; + hi + &#x27;px;line-height:&#x27; + hi + &#x27;px;&quot;&gt;&#x27; + s.wheels[i][label][j] + &#x27;&lt;/li&gt;&#x27;;
                    }
                    html += &#x27;&lt;/ul&gt;&lt;div class=&quot;dwwo&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&quot;dwwol&quot;&gt;&lt;/div&gt;&lt;div class=&quot;dwwol-bottom&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/td&gt;&#x27;;
                }
                html += &#x27;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&#x27;;
            }
            html += (s.display != &#x27;inline&#x27; ? &#x27;&lt;div class=&quot;dwbc&quot;&gt;&lt;span class=&quot;dwbw dwb-s&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;dwb&quot;&gt;&#x27; + s.setText + &#x27;&lt;/a&gt;&lt;/span&gt;&lt;span class=&quot;dwbw dwb-c&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;dwb&quot;&gt;&#x27; + s.cancelText + &#x27;&lt;/a&gt;&lt;/span&gt;&lt;/div&gt;&#x27; : &#x27;&lt;div class=&quot;dwcc&quot;&gt;&lt;/div&gt;&#x27;) + &#x27;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&#x27;;

            dw = $(html);

            scrollToPos();

            // Show
            s.display != &#x27;inline&#x27; ? dw.appendTo(&#x27;body&#x27;) : elm.is(&#x27;div&#x27;) ? elm.html(dw) : dw.insertAfter(elm);
            visible = true;

            // Theme init
            theme.init(dw, that);

            if (s.display != &#x27;inline&#x27;) {
                // Init buttons
                $(&#x27;.dwb-s a&#x27;, dw).click(function () {
                    that.setValue(false, true);
                    that.hide();
                    s.onSelect.call(e, that.val, that);
                    return false;
                });

                $(&#x27;.dwb-c a&#x27;, dw).click(function () {
                    that.hide();
                    s.onCancel.call(e, that.val, that);
                    return false;
                });

                // Disable inputs to prevent bleed through (Android bug)
                $(&#x27;input,select&#x27;).each(function() {
                    if (!$(this).prop(&#x27;disabled&#x27;))
                        $(this).addClass(&#x27;dwtd&#x27;);
                });
                $(&#x27;input,select&#x27;).prop(&#x27;disabled&#x27;, true);

                // Set position
                position();
                $(window).bind(&#x27;resize.dw&#x27;, position);
            }

            // Events
            dw.delegate(&#x27;.dwwl&#x27;, &#x27;DOMMouseScroll mousewheel&#x27;, function (e) {
                if (!s.readonly) {
                    e.preventDefault();
                    e = e.originalEvent;
                    var delta = e.wheelDelta ? (e.wheelDelta / 120) : (e.detail ? (-e.detail / 3) : 0),
                        t = $(&#x27;ul&#x27;, this),
                        p = +t.data(&#x27;pos&#x27;),
                        val = Math.round(p - delta);
                    setGlobals(t);
                    calc(t, val, delta &lt; 0 ? 1 : 2);
                }
            }).delegate(&#x27;.dwb, .dwwb&#x27;, START_EVENT, function (e) {
                // Active button
                $(this).addClass(&#x27;dwb-a&#x27;);
            }).delegate(&#x27;.dwwb&#x27;, START_EVENT, function (e) {
                if (!s.readonly) {
                    // + Button
                    e.preventDefault();
                    e.stopPropagation();
                    var t = $(this).closest(&#x27;.dwwl&#x27;).find(&#x27;ul&#x27;)
                        func = $(this).hasClass(&#x27;dwwbp&#x27;) ? plus : minus;
                    setGlobals(t);
                    clearInterval(timer);
                    timer = setInterval(function() { func(t); }, s.delay);
                    func(t);
                }
            }).delegate(&#x27;.dwwl&#x27;, START_EVENT, function (e) {
                // Scroll start
                if (!move &amp;&amp; s.mode != &#x27;clickpick&#x27; &amp;&amp; !s.readonly) {
                    e.preventDefault();
                    move = true;
                    target = $(&#x27;ul&#x27;, this).addClass(&#x27;dwa&#x27;);
                    if (s.mode == &#x27;mixed&#x27;)
                        $(&#x27;.dwwb&#x27;, this).fadeOut(&#x27;fast&#x27;);
                    pos = +target.data(&#x27;pos&#x27;);
                    setGlobals(target);
                    start = getY(e);
                    startTime = new Date();
                    stop = start;
                    that.scroll(target, pos);
                }
            });

            s.onShow.call(e, dw, that);
        }

        /**
        * Scroller initialization.
        */
        that.init = function(ss) {
            // Get theme defaults
            theme = $.extend({ defaults: {}, init: empty }, $.scroller.themes[ss.theme ? ss.theme : s.theme]);

            $.extend(s, theme.defaults, settings, ss);

            that.settings = s;

            m = Math.floor(s.rows / 2);

            var preset = $.scroller.presets[s.preset];

            elm.unbind(&#x27;.dw&#x27;);

            if (preset) {
                var p = preset.call(e, that)
                $.extend(s, p, settings, ss)
                // Extend core methods
                $.extend(methods, p.methods);
            }

            if (elm.data(&#x27;dwro&#x27;) !== undefined)
                e.readOnly = bool(elm.data(&#x27;dwro&#x27;));

            if (visible)
                that.hide();

            if (s.display == &#x27;inline&#x27;) {
                that.show();
            }
            else {
                read();
                if (input &amp;&amp; s.showOnFocus) {
                    // Set element readonly, save original state
                    elm.data(&#x27;dwro&#x27;, e.readOnly);
                    e.readOnly = true;
                    // Init show datewheel
                    elm.bind(&#x27;focus.dw&#x27;, that.show);
                }
            }
        }

        that.values = null;
        that.val = null;
        that.temp = null;

        that.init(settings);
    }

    function testProps(props) {
        for (var i in props) {
            if (mod[props[i]] !== undefined ) {
                return true;
            }
        }
        return false;
    }

    function testPrefix() {
        var prefixes = [&#x27;Webkit&#x27;, &#x27;Moz&#x27;, &#x27;O&#x27;, &#x27;ms&#x27;];
        for (var p in prefixes) {
            if (testProps([prefixes[p] + &#x27;Transform&#x27;]))
                return &#x27;-&#x27; + prefixes[p].toLowerCase();
        }
        return &#x27;&#x27;;
    }

    function getInst(e) {
        return scrollers[e.id];
    }

    function getY(e) {
        return touch ? (e.originalEvent ? e.originalEvent.changedTouches[0].pageY : e.changedTouches[0].pageY) : e.pageY;
    }

    function bool(v) {
        return (v === true || v == &#x27;true&#x27;);
    }

    function calc(t, val, dir, anim, orig) {
        var i = t.closest(&#x27;.dwwr&#x27;).find(&#x27;ul&#x27;).index(t);

        val = val &gt; max ? max : val;
        val = val &lt; min ? min : val;

        var cell = $(&#x27;li&#x27;, t).eq(val);

        // Set selected scroller value
        inst.temp[i] = cell.attr(&#x27;data-val&#x27;);

        // Validate
        inst.validate(anim ? (val == orig ? 0.1 : Math.abs((val - orig) * 0.1)) : 0, orig, i, dir);
    }

    var scrollers = {},
        timer,
        empty = function() {},
        h,
        min,
        max,
        inst, // Current instance
        date = new Date(),
        uuid = date.getTime(),
        move = false,
        target = null,
        start,
        stop,
        startTime,
        endTime,
        pos,
        mod = document.createElement(&#x27;modernizr&#x27;).style,
        has3d = testProps([&#x27;perspectiveProperty&#x27;, &#x27;WebkitPerspective&#x27;, &#x27;MozPerspective&#x27;, &#x27;OPerspective&#x27;, &#x27;msPerspective&#x27;]) &amp;&amp; &#x27;webkitPerspective&#x27; in document.documentElement.style,
        prefix = testPrefix(),
        touch = (&#x27;ontouchstart&#x27; in window),
        START_EVENT = touch ? &#x27;touchstart&#x27; : &#x27;mousedown&#x27;,
        MOVE_EVENT = touch ? &#x27;touchmove&#x27; : &#x27;mousemove&#x27;,
        END_EVENT = touch ? &#x27;touchend&#x27; : &#x27;mouseup&#x27;,
        defaults = {
            // Options
            width: 70,
            height: 40,
            rows: 3,
            delay: 300,
            disabled: false,
            readonly: false,
            showOnFocus: true,
            showLabel: true,
            wheels: [],
            theme: &#x27;&#x27;,
            headerText: &#x27;{value}&#x27;,
            display: &#x27;modal&#x27;,
            mode: &#x27;scroller&#x27;,
            preset: &#x27;&#x27;,
            setText: &#x27;确认&#x27;,
            cancelText: &#x27;取消&#x27;,
            // Events
            onShow: empty,
            onClose: empty,
            onSelect: empty,
            onCancel: empty,
            onChange: empty,
            formatResult: function(d) {
                var out = &#x27;&#x27;;
                for (var i = 0; i &lt; d.length; i++) {
                    out += (i &gt; 0 ? &#x27; &#x27; : &#x27;&#x27;) + d[i];
                }
                return out;
            },
            parseValue: function(val, inst) {
                var w = inst.settings.wheels,
                    val = val.split(&#x27; &#x27;),
                    ret = [],
                    j = 0;
                for (var i = 0; i &lt; w.length; i++) {
                    for (var l in w[i]) {
                        if (w[i][l][val[j]] !== undefined)
                            ret.push(val[j])
                        else
                            // Select first value from wheel
                            for (var v in w[i][l]) {
                                ret.push(v);
                                break;
                            }
                        j++;
                    }
                }
                return ret;
            },
            validate: empty
        },

        methods = {
            init: function (options) {
                if (options === undefined) options = {};
                return this.each(function () {
                    if (!this.id) {
                        uuid += 1;
                        this.id = &#x27;scoller&#x27; + uuid;
                    }
                    scrollers[this.id] = new Scroller(this, options);
                });
            },
            enable: function() {
                return this.each(function () {
                    var inst = getInst(this);
                    if (inst) inst.enable();
                });
            },
            disable: function() {
                return this.each(function () {
                    var inst = getInst(this);
                    if (inst) inst.disable();
                });
            },
            isDisabled: function() {
                var inst = getInst(this[0]);
                if (inst)
                    return inst.settings.disabled;
            },
            option: function(option, value) {
                return this.each(function () {
                    var inst = getInst(this);
                    if (inst) {
                        var obj = {};
                        if (typeof option === &#x27;object&#x27;)
                            obj = option;
                        else
                            obj[option] = value;
                        inst.init(obj);
                    }
                });
            },
            setValue: function(d, fill, time) {
                return this.each(function () {
                    var inst = getInst(this);
                    if (inst) {
                        inst.temp = d;
                        inst.setValue(true, fill, time);
                    }
                });
            },
            getInst: function() {
                return getInst(this[0]);
            },
            getValue: function() {
                var inst = getInst(this[0]);
                if (inst)
                    return inst.values;
            },
            show: function() {
                var inst = getInst(this[0]);
                if (inst)
                    return inst.show();
            },
            hide: function() {
                return this.each(function () {
                    var inst = getInst(this);
                    if (inst)
                        inst.hide();
                });
            },
            destroy: function() {
                return this.each(function () {
                    var inst = getInst(this);
                    if (inst) {
                        inst.hide();
                        $(this).unbind(&#x27;.dw&#x27;);
                        delete scrollers[this.id];
                        if ($(this).is(&#x27;input&#x27;))
                            this.readOnly = bool($(this).data(&#x27;dwro&#x27;));
                    }
                });
            }
        };

    $(document).bind(MOVE_EVENT, function (e) {
        if (move) {
            e.preventDefault();
            stop = getY(e);
            var val = pos + (start - stop) / h;
            val = val &gt; (max + 1) ? (max + 1) : val;
            val = val &lt; (min - 1) ? (min - 1) : val;
            inst.scroll(target, val);
        }
    });

    $(document).bind(END_EVENT, function (e) {
        if (move) {
            e.preventDefault();
            target.removeClass(&#x27;dwa&#x27;);
            var time = new Date() - startTime,
                val = pos + (start - stop) / h;
            val = val &gt; (max + 1) ? (max + 1) : val;
            val = val &lt; (min - 1) ? (min - 1) : val;

            if (time &lt; 300) {
                var speed = (stop - start) / time;
                var dist = (speed * speed) / (2 * 0.0006);
                if (stop - start &lt; 0) dist = -dist;
            }
            else {
                var dist = stop - start;
            }
            calc(target, Math.round(pos - dist / h), 0, true, Math.round(val));
            move = false;
            target = null;
        }
        clearInterval(timer);
        $(&#x27;.dwb-a&#x27;).removeClass(&#x27;dwb-a&#x27;);
    });

    $.fn.scroller = function (method) {
        if (methods[method]) {
            return methods[method].apply(this, Array.prototype.slice.call(arguments, 1));
        }
        else if (typeof method === &#x27;object&#x27; || !method) {
            return methods.init.apply(this, arguments);
        }
        else {
            $.error(&#x27;Unknown method&#x27;);
        }
    }

    $.scroller = {
        /**
        * Set settings for all instances.
        * @param {Object} o - New default settings.
        */
        setDefaults: function(o) {
            $.extend(defaults, o);
        },

        presets: {},
        themes: {}
    };

}));

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
